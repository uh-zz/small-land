---
title: 'システム設計-part3-'
date: 2020-12-05T18:07:06+09:00
description:
menu:
  sidebar:
    name: システム設計-part3-
    identifier: principles-of-the-systems-architecture-part3
    parent: system-design
    weight: 10
images:
  - images/bio_1.jpg
tags: ['system-design', 'ddd']
categories: ['system-design', 'ddd']
---

## はじめに

バックエンドエンジニアの[ロードマップ][ロードマップ]に沿ってエンジニアとしての自己肯定感を養うシリーズです。

※[現場で役立つシステム設計の原則][現場で役立つシステム設計の原則]を元に記事を作成しています。

## 業務ロジック

### メソッドをロジックの置き場所にする

[現場で役立つシステム設計の原則][現場で役立つシステム設計の原則]では、"従来"という表現をされていますが、手続き型と呼ばれている設計ではデータクラスと機能クラスに分けて表現します。

その名の通りデータクラスはデータを格納して、機能クラスはデータクラスのデータを判断、加工、計算するといった使い方です。

この手続き型の問題は、拡張するときの変更箇所の特定に時間がかかるということです。

なぜかというと、データクラスが参照できるクラスであれば、アーキテクチャのどのレイヤーにでもロジックが書けてしまうからです。

便利のようには見えますが、先に言った変更箇所の特定に時間がかかるこの方法は最善ではありません。

解決としては、Java 本来のクラスの使い方を踏襲することです。

データとロジックを 1 つのクラスに閉じてしまおうという考え方です。

```
class PersonName {
  private String firstName;

  private String lastName;

  String fullName() {
    return String.format("%s %s", firstName, lastName);
  }
}
```

データである`firstName`と`lastName`、そしてロジック(メソッド)の`fullName()`が同じクラス内にあります。

こうするとクラス内でデータを扱うことができて変更もこのクラス内で閉じることができます。

また、メソッドはクラス内のインスタンス変数(`firstName`や`lastName`)を使って何らかの処理を行う用途で作成します。

### クラスが肥大化したら小さく分ける

これもやってしまいがちですが、改修を繰り返していくうちに、クラスが大きくなっていきます。

大きくなったクラスは手続き型同様に変更箇所の特定に時間がかかります。

それを防ぐために、大きくなってしまったクラスを次のルールで細分化します。

- インスタンス変数とメソッドを対応付ける
- メソッドが全てのインスタンス変数を使うようになる

細分化したクラスはそれぞれ独立性が高くなるので、別のクラスで使う時にも再利用ができるようになります。

こうした関連の強いデータとロジックをまとめたクラスを**凝集度が高い**と言います。

凝集度が高いクラスは、変更箇所もそのクラスに閉じることになるので、疎結合になり他への影響が少なくて済みます。

## まとめ

時すでに遅しと言いますか、現場での反省点をつらつら振り返ってベストプラクティスを学んでいるという感じです。

次回に活かそうというモチベーションは上がるのでいい復習方法だと感じます。

## 備考

[現場で役立つシステム設計の原則][現場で役立つシステム設計の原則]

表紙イラスト：[Loose Drawing](https://loosedrawing.com/)

[ロードマップ]: https://github.com/kamranahmedse/developer-roadmap#back-end-roadmap
[現場で役立つシステム設計の原則]: https://www.amazon.co.jp/%E7%8F%BE%E5%A0%B4%E3%81%A7%E5%BD%B9%E7%AB%8B%E3%81%A4%E3%82%B7%E3%82%B9%E3%83%86%E3%83%A0%E8%A8%AD%E8%A8%88%E3%81%AE%E5%8E%9F%E5%89%87-%E5%A4%89%E6%9B%B4%E3%82%92%E6%A5%BD%E3%81%A7%E5%AE%89%E5%85%A8%E3%81%AB%E3%81%99%E3%82%8B%E3%82%AA%E3%83%96%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88%E6%8C%87%E5%90%91%E3%81%AE%E5%AE%9F%E8%B7%B5%E6%8A%80%E6%B3%95-%E5%A2%97%E7%94%B0-%E4%BA%A8/dp/477419087X
